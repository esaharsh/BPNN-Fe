# ---------------------------------------------
# Generate Fe dataset: lattice, density, pressure, etc.
# ---------------------------------------------
units           metal
atom_style      atomic
boundary        p p p
variable        latconsts index 2.85 2.86 2.87 2.88
variable        temps index 100 300 600 900
variable        mass equal 55.845

# Output file
fix             mydump all print 0 "lattice_constant density atomic_mass temperature pressure volume_per_atom coordination_number nearest_neighbor_distance" file fe_dataset.csv screen no

# Loop over lattice constants
label loop_a
variable a equal ${latconsts}
lattice         bcc ${a}
region          box block 0 10 0 10 0 10
create_box      1 box
create_atoms    1 box

mass            1 ${mass}
pair_style      eam/alloy
pair_coeff      * * Fe_mm.eam.alloy Fe

# Compute quantities
compute         myTemp all temp
compute         myPress all pressure myTemp
compute         myRDF all rdf 100
compute         myCoord all coord/atom cutoff 3.0
compute         myReduce all reduce ave c_myCoord
compute         myChunk all chunk/atom bin/1d x lower 1 units box

# Neighbor settings
neighbor        2.0 bin
neigh_modify    delay 5 every 1

# Equilibration loop over temperature
label loop_t
variable T equal ${temps}

velocity        all create ${T} 12345 mom yes rot yes dist gaussian
fix             nptfix all npt temp ${T} ${T} 0.1 iso 0 0 1.0
thermo_style    custom step temp press density pe ke etotal vol
thermo          100

run             2000
unfix           nptfix

# Collect averages
variable        dens equal density
variable        press equal press
variable        vol equal vol/atoms
variable        temp equal temp
# Estimate coordination number (approx average)
variable        coord equal c_myReduce
# Estimate nearest-neighbor distance (first RDF peak)
variable        rnn equal ave(c_myRDF[1:3])

fix             append all print 1 "${a} ${dens} ${mass} ${temp} ${press} ${vol} ${coord} ${rnn}" append fe_dataset.csv screen no

clear
next            temps
jump            SELF loop_t

next            latconsts
jump            SELF loop_a

print "Dataset generation completed."
